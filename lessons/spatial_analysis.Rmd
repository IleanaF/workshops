```{r setup, echo=FALSE, warning=FALSE, purl=FALSE, message=FALSE}
options(repos="http://cran.rstudio.com/")
pkgs <- c("sf","sp","rgdal","rgeos","raster","knitr")
x<-lapply(pkgs, library, character.only = TRUE)
opts_chunk$set(tidy=T)
```

# Spatial/GIS Analysis with R

Given the size of this topic and limited time we have to spend on it this introduction of Spatial and GIS analyses with R is going to focus on one type of spatial data, vector, and one class of spatial data structures in r, simple features.

## Lesson Outline
- [Required packages](#required-spatial-packages)
- [Read in spatial data](#read-in-spatial-data)
- [Spatial data manipulation](#spatial-data-manipulation)
- [Projections](#projections)
- [Spatial data visualization](#spatial-data-visualization)
- [Example spatial workflow](#example-spatial-workflow)

## Lesson Exercises
- [Exercise 1](#exercise-1)
- [Exercise 2](#exercise-2)
- [Exercise 3](#exercise-3)

## Required packages

 Since the late 2000's there has been a rapid increase in the spatial data handling and analysis capability of R.  The `rgdal`, `rgeos`, `raster`, and `sp` packages (through the very significant effort of the package authors) provided the foundation for doing GIS entirely within R. More recently a new route for handling vector data has emerged in the [`sf` package](https://cran.r-project.org/package=sf).  Most current development for vector processing is focusing on `sf`.  As such, this workshop will as well.  Raster data is still dealt with via [`raster`](https://cran.r-project.org/package=raster). As mentioned, in this workshop we will only be focusing on a single class of data: vector data as represented by simple features.  Thus, we only need a single package. 

### sf
The [`sf` package](http://r-spatial.github.io/sf/) provides vector data handling via the Simple Features standard, an Open Geospatial Consortium and International Standards Organization standard for spatial data. In addition, `sf` provides a tidy spatial data format that allows for manipulation with the popular `dplyr` package.

Getting `sf` added is no different than adding any other package that is on CRAN.

```{r add_sp, eval=FALSE}
install.packages("sf")
library("sf")
```

## Read in spatial data 

For this workshop, I have collected a couple of example datasets to use and have included them in this repository.  So, let's first grab the dataset.  It is stored as a zip file.  You can download it [directly from this link](https://usepa.github.io/cerf_r/data.zip), but most of you should have done this prior to the workshop.  Let's find this file and unzip it into our project.  We can do this via our trusty point and click methods or we can use R.

```{r}
unzip("C:/Users/JHollist/Downloads/data.zip",)
```


For many, shapefiles are going to be the most common way to interact with spatial data.  With `sf`, reading in in shapefiles is straightforward via the `st_read()` function.

```{r read_shp}
dc_metro <- st_read(here("data/Metro_Lines.shp"))
```

We will get more into working with `sf` object and visualizing spatial data later, but just to prove that this did something:

```{r metro_chk}
dc_metro
plot(dc_metro)
```

The spatial data types that `sf` recognizes follow the general concept of points, lines and polygons.  You can see for this that the Metro Lines are read in as a MUTLILINESTRING.  Details on these are beyond what we can cover in this short workshop, but the `sf` documentation does a good job, in particular the [Simple Features in R vignette](https://r-spatial.github.io/sf/articles/sf1.html).

## Exercise 1

## Spatial data manipulation

## Projections

## Exercise 2

## Spatial data visualization

## Exercise 3

## Example spatial workflow


